@namespace EasyCsv.Components
@inherits EasyCsvStrategyOptionsBase
@if (CsvProcessor?.CurrentState != null)
{
    <MudSelect Immediate="Immediate" Disabled="Disabled" Label="Columns To Join" T="string" MultiSelection="true" MultiSelectionTextFunc="@(x => string.Join(", ", x))" SelectedValues="SelectedValues" SelectedValuesChanged="x => SelectedValues = x?.ToArray() ?? []">
        @foreach (var value in CsvProcessor.CurrentState.ColumnNames()!.Where(x => x.Equals(InternalColumnNames.Tags, StringComparison.OrdinalIgnoreCase) == false))
        {
            <MudSelectItem Value="value">@value</MudSelectItem>
        }
    </MudSelect>
}

@code {
    [Parameter] public EventCallback<string[]> SelectedValuesChanged { get; set; }
    private string[] _selectedValues = [];
    [Parameter] public string[] SelectedValues
    {
        get => _selectedValues;
        set
        {
            if (value == null!) return;
            if (_selectedValues.Length == value.Length && _selectedValues.All(value.Contains))
            {
                return;
            }
            _selectedValues = value;
            SelectedValuesChanged.InvokeAsync(value);
        }
    }
    [Parameter] public bool Immediate { get; set; } = true;
    [Parameter] public bool Disabled { get; set; }
}
