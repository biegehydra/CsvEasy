@namespace EasyCsv.Components

@if (CsvProcessor == null)
{
    throw new ArgumentException("EasyCsv: Attempted to render strategy options not within CsvProcessingStepper", nameof(CsvProcessingStepper));
}
<StrategyItem DisplayName="Divide And Replicate" Description="Splits column on value" AllowRun="AllowRun" StrategyPicked="DivideAndReplicate">
    <Options>
        <MudListItem>
            <MudTextField Placeholder="Delimiter" Variant="Variant.Outlined" @bind-Value="_delimiter"></MudTextField>
        </MudListItem>
    </Options>
</StrategyItem>

@code
{
    [CascadingParameter] public CsvProcessingStepper CsvProcessor { get; set; } = null!;
    private bool AllowRun => !string.IsNullOrWhiteSpace(_delimiter);
    private string? _delimiter;
    private async Task DivideAndReplicate(string columnName)
    {
        if (!AllowRun) return;
        var splitParsingStrategy = new DivideAndReplicate(columnName, y => y?.ToString()?.Split(_delimiter).Cast<object?>().ToArray());
        _ = await CsvProcessor.PerformCsvStrategy(splitParsingStrategy);
    }
}
